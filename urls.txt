from django.urls import path
from django.views.generic import TemplateView
from django.contrib.auth import login
from django.contrib.auth.models import User
from django.shortcuts import redirect
from . import views

def auto_login(request):
    try:
        user = User.objects.get(username='mutinda')
        login(request, user)
        return redirect('/clients/dashboard/')
    except User.DoesNotExist:
        user = User.objects.create_user('mutinda', 'eminentwriters8@gmail.com', '123admin')
        user.is_staff = True
        user.is_superuser = True
        user.save()
        login(request, user)
        return redirect('/clients/dashboard/')

urlpatterns = [
    # Existing Client URLs
    path('', views.client_list, name='client_list'),
    path('new/', views.client_create, name='client_create'),
    path('dashboard/', views.client_dashboard, name='client_dashboard'),
    path('about/', TemplateView.as_view(template_name='about.html'), name='about'),
    path('auto-login/', auto_login, name='auto_login'),
    path('location/<int:client_id>/', views.client_location_pin, name='client_location_pin'),
    path('location/save/<int:client_id>/', views.save_client_location, name='save_client_location'),
    
    # WhatsApp URLs
    path('whatsapp/compose/', views.whatsapp_bulk_send, name='whatsapp_compose'),
    path('whatsapp/results/', views.whatsapp_results, name='whatsapp_results'),
    path('whatsapp/reminders/', views.whatsapp_payment_reminders, name='whatsapp_reminders'),
    
    # NEW: Network Monitor URLs
    path('network/dashboard/', views.network_dashboard, name='network_dashboard'),
    path('network/live/', views.network_live_dashboard, name='network_live_dashboard'),
    path('network/api/traffic/', views.network_traffic_api, name='network_traffic_api'),
    path('network/api/alerts/', views.network_alerts_api, name='network_alerts_api'),
    path('network/api/health/', views.network_health_check, name='network_health_check'),
    path('network/api/usage/', views.network_usage_breakdown, name='network_usage_api'),
    path('network/api/peak-hours/', views.network_peak_hours, name='network_peak_hours'),
    path('dashboard/combined/', views.combined_dashboard, name='combined_dashboard'),
]