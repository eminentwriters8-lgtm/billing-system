{% extends "clients/base_management.html" %}
{% block title %}Reset History - Billing System{% endblock %}
{% block page_title %}System Reset History{% endblock %}

{% block content %}
<div class="stats">
    <div class="stat-card">
        <h3>Total Resets</h3>
        <p style="font-size: 24px; margin: 0;">{{ total_resets }}</p>
    </div>
    <div class="stat-card">
        <h3>Recent Resets (30 days)</h3>
        <p style="font-size: 24px; margin: 0;">{{ recent_resets }}</p>
    </div>
</div>

<!-- Perform Reset -->
<div class="section" style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
    <h3>Perform System Reset</h3>
    <form method="post">
        {% csrf_token %}
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px; margin-bottom: 10px;">
            <select name="reset_type" required>
                <option value="">Select Reset Type</option>
                <option value="network_stats">Reset Network Statistics</option>
                <option value="test_data">Reset Test Data</option>
                <option value="cache">Clear System Cache</option>
            </select>
            <input type="text" name="reset_details" placeholder="Reset Details (Optional)">
        </div>
        <button type="submit" class="btn btn-warning">Perform Reset</button>
        <small style="display: block; margin-top: 5px; color: #666;">
            Note: Some reset operations cannot be undone.
        </small>
    </form>
</div>

<!-- Reset History -->
<div class="section" style="background: white; padding: 20px; border-radius: 8px;">
    <h3>Reset History</h3>
    {% if reset_logs %}
    <table class="table">
        <thead>
            <tr>
                <th>Date & Time</th>
                <th>Reset Type</th>
                <th>Performed By</th>
                <th>Details</th>
            </tr>
        </thead>
        <tbody>
            {% for log in reset_logs %}
            <tr>
                <td>{{ log.reset_date|date:"M d, Y H:i" }}</td>
                <td>{{ log.reset_type|title }}</td>
                <td>{{ log.reset_by.username }}</td>
                <td>{{ log.description }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No reset history found.</p>
    {% endif %}
</div>
{% endblock %}
